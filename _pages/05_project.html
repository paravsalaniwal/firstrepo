---
layout: base
permalink: /JSproject/
title: JS Project ðŸ’»
---
<html>
<head>
  <title>Music Search</title>
  <style>
    table {
      border-collapse: collapse;
      width: 100%;
    }

    th, td {
      text-align: left;
      padding: 8px;
    }

    th {
      cursor: pointer;
    }

    input[type="text"] {
      width: 100%;
      padding: 8px;
      margin-bottom: 10px;
    }

    .album-artwork {
      width: 100px;
      height: auto;
    }
  </style>
</head>
<body>
  <h1>Music Search</h1>

  <input type="text" id="searchInput" placeholder="Search by Song Title..." />

  <table id="dataTable">
    <thead>
      <!-- the table is made to sort on click by alphabetical -->
      <tr>
        <th onclick="sortTable(0)">Track Name</th>
        <th onclick="sortTable(1)">Artist</th>
        <th onclick="sortTable(2)">Album</th>
        <th onclick="sortTable(3)">Duration</th>
        <th onclick="sortTable(4)">Album Artwork</th>
        <th onclick="sortTable(5)">Preview</th>
      </tr>
    </thead>
    <tbody id="dataBody"></tbody>
  </table>

  <script>
    // fetch the data for music all across iTunes using their API and display in table
    async function fetchMusicData() { // async allows two things happen at the same time
      const searchTerm = document.getElementById('searchInput').value; // gets the user search input and goes to the api
      const response = await fetch(`https://itunes.apple.com/search?term=${encodeURIComponent(searchTerm)}&entity=song&limit=50`); // gets the info based on the user input through fetch
      const data = await response.json(); // prints the data in json format so its easy to read and present
      const tableBody = document.getElementById('dataBody'); // puts the information on the body of the table

      // sets it to clear the html table right before the next input request is entered
      tableBody.innerHTML = '';

      // loops (using for loops) through every song which has the keywords in the title and displays as a new row in the table
      data.results.forEach(song => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${song.trackName}</td>
          <td>${song.artistName}</td>
          <td>${song.collectionName}</td>
          <td>${formatDuration(song.trackTimeMillis)}</td>
          <td><img class="album-artwork" src="${song.artworkUrl100}" alt="Album Artwork"></td>
          <td><audio src="${song.previewUrl}" controls></audio></td>
        `;
        tableBody.appendChild(row); // appends the data to the table in the appropriate row
      });
    }

    // sorting the table in ascending or descending
    function sortTable(columnIndex) {
      const table = document.getElementById('dataTable'); // takes all of the data fron the table currently
      const rows = Array.from(table.rows).slice(1);  // slice(1) returns as a new array skipping the first row since 1st is header
      const isAscending = table.rows[0].cells[columnIndex].classList.toggle('asc'); // sorts all that in ascending order

      // sorts table one by one row by row
      rows.sort((row1, row2) => {
        const cellValue1 = row1.cells[columnIndex].innerText;
        const cellValue2 = row2.cells[columnIndex].innerText;

        // compares the values when getting sorted in alphabetical order or reverse alphabetical
        if (isNaN(cellValue1) || isNaN(cellValue2)) {
          return cellValue1.localeCompare(cellValue2);
        } else {
          return cellValue1 - cellValue2;
        }
      });

      // reverses the rows if descending
      if (!isAscending) {
        rows.reverse();
      }

      // append the new organized data and expands the array of rows
      table.tBodies[0].append(...rows);
    }

    // duration changing from milli to minutes because iTunes API uses milliseconds
    function formatDuration(durationInMillis) {
      const minutes = Math.floor(durationInMillis / 60000);
      const seconds = ((durationInMillis % 60000) / 1000).toFixed(0);
      return `${minutes}:${seconds.padStart(2, '0')}`;
    }

    // triggers the data to be fetched when enter key is hit
    const searchInput = document.getElementById('searchInput');
    searchInput.addEventListener('keyup', function(event) {
      if (event.key === 'Enter') {
        fetchMusicData();
      }
    });

    // fetch music
    fetchMusicData();
  </script>
</body>
</html>
